<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <data>
        <record id="tms_product_search_form_view" model="ir.ui.view">
            <field name="name">tms.product.search.form</field>
            <field name="model">product.product</field>
            <field name="priority">50</field>
            <field name="inherit_id" ref="product.product_search_form_view"/>
            <field name="arch" type="xml">
                <search string="Product">
                    <field name="categ_id" position="after">
                        <filter domain="[('tms_category','in',('transportable','freight','move','insurance','highway_tolls','other'))]" icon="terp-accessories-archiver" string="Waybill Related"/>
                        <separator/>
                        <filter domain="[('tms_category','in',('real_expense','salary','salary_retention','salary_discount','negative_balance','fuel','madeup_expense'))]" icon="terp-accessories-archiver" string="Travel Expense Related"/>
                        <separator/>
                        <filter domain="[('tms_category','=','indirect_expense')]" icon="terp-accessories-archiver" name="indirect_expense" string="Indirect Expense (Agreements)"/>
                    </field>
                    <group expand="0" string="More groups...">
                        <separator/>
                        <filter context="{'group_by' : 'tms_category'}" domain="[]" icon="terp-stock_symbol-selection" string="TMS Type"/>
                    </group>
                </search>
            </field>
        </record>
        <record id="tms_product_normal_tree_view" model="ir.ui.view">
            <field name="name">TMS product.normal.tree</field>
            <field name="model">product.product</field>
            <field name="priority">50</field>
            <field name="inherit_id" ref="product.product_product_tree_view"/>
            <field name="arch" type="xml">
                <field name="uom_id" position="after">
                    <field name="tms_category"/>
                </field>
            </field>
        </record>
        <record id="tms_product_normal_form_view" model="ir.ui.view">
            <field name="name">TMS product.normal.form</field>
            <field name="model">product.product</field>
            <field name="priority">50</field>
            <field name="inherit_id" ref="product.product_normal_form_view"/>
            <field name="arch" type="xml">
                <field name="lst_price" position="after">
                    <separator colspan="2" string="TMS"/>
                    <newline/>
                    <field name="tms_category" on_change="onchange_tms_category(tms_category)" required="True"/>
                    <newline/>
                    <field attrs="{'invisible':[('tms_category','!=','freight')]}" name="tms_default_freight"/>
                    <newline/>
                    <field attrs="{'invisible':[('tms_category','!=','freight')]}" name="tms_default_supplier_freight"/>
                    <newline/>
                    <field attrs="{'invisible':[('tms_category','!=','salary')]}" name="tms_default_salary"/>
                    <new_line/>
                    <field attrs="{'invisible':[('tms_category','!=','salary_discount')]}" name="tms_default_fuel_discount"/>
                    <newline/>
                    <field attrs="{'invisible':[('tms_category','!=','maint_activity')], 'required':[('tms_category','=','maint_activity')]}" name="tms_activity_duration" widget="float_time"/>
                </field>
                <notebook position="inside">
                    <page attrs="{'invisible':[('tms_category','!=','indirect_expense')]}" string="TMS Expense Accounts">
                        <field name="tms_account_ids" nolabel="1"/>
                    </page>
                </notebook>
                <field name="property_account_income_id" position="after">
                    <field domain="[('type','=','other')]" name="tms_property_account_income"/>
                    <!-- attrs="{'required':[('tms_category','in',('freight', 'insurance', 'highway_tolls','other'))], 'invisible' : [('tms_category','not in',('freight', 'insurance', 'highway_tolls','other'))]}" -->
                </field>
                <field name="property_account_expense_id" position="after">
                    <field domain="[('type','=','other')]" name="tms_property_account_expense"/>
                    <!-- attrs="{'required':[('tms_category','in',('fuel'))], 'invisible' : [('tms_category','not in',('fuel'))]}" -->
                </field>
                <field name="property_stock_production" position="replace">
                    <field domain="[('usage','=','production')]" name="property_stock_production"/>
                </field>
            </field>
        </record>
        <record id="tms_product_normal_action" model="ir.actions.act_window">
            <field name="name">Products</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">product.product</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form,kanban</field>
            <field name="view_id" ref="product.product_product_tree_view"/>
            <field name="search_view_id" ref="tms_product_search_form_view"/>
            <field name="domain">[('tms_category','in',('transportable','freight','move','insurance','highway_tolls','other','real_expense','madeup_expense','salary','salary_retention','salary_discount','negative_balance','fuel','indirect_expense'))]</field>
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">Click to define a new Freight related product.
              </p>
                <p>You can define products for everything related to Freight Management.
              </p>
            </field>
        </record>
        <menuitem action="tms_product_normal_action" id="menu_tms_config_product_product" parent="menu_tms_config_product" sequence="1"/>
    </data>
</odoo>